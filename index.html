<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gratis Vacature Analyse - 40-60% Meer Sollicitaties | KandidatenTekort.nl</title>
    <meta name="description" content="Upload je vacature en ontvang direct een AI-powered analyse. Krijg binnen 24 uur een geoptimaliseerde versie die 40-60% meer sollicitaties genereert.">

    <!-- Security & SEO Headers -->
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://kandidatentekort.nl/">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Recruitin Brand Colors */
            --recruitin-orange: #ff6b35;
            --recruitin-orange-light: #ff8a5e;
            --recruitin-orange-dark: #e55a2b;
            --recruitin-blue: #2c3e50;
            --recruitin-blue-light: #34495e;
            --recruitin-blue-dark: #1a252f;

            /* Legacy aliases (voor backwards compatibility) */
            --orange: var(--recruitin-orange);
            --orange-light: var(--recruitin-orange-light);
            --orange-dark: var(--recruitin-orange-dark);
            --blue: var(--recruitin-blue);
            --blue-light: var(--recruitin-blue-light);

            /* Supporting Colors */
            --green: #10b981;
            --yellow: #f59e0b;

            /* Grays */
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-900: #111827;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--gray-900);
            background: linear-gradient(135deg, #fff5f2 0%, #e8f4f8 100%);
            /* Recruitin branded gradient: orange tint to blue tint */
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: white;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--blue);
            margin-bottom: 10px;
        }

        .logo .accent {
            color: var(--orange);
        }

        .tagline {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 15px;
        }

        .subtitle {
            font-size: 1.125rem;
            color: var(--gray-600);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Main Upload Section */
        .upload-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--blue);
            margin-bottom: 10px;
            text-align: center;
        }

        .section-subtitle {
            text-align: center;
            color: var(--gray-600);
            margin-bottom: 30px;
        }

        /* Tab Switcher */
        .tab-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--gray-100);
            padding: 5px;
            border-radius: 12px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--gray-600);
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: white;
            color: var(--orange);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* File Upload Zone */
        .upload-zone {
            border: 3px dashed var(--gray-200);
            border-radius: 16px;
            padding: 60px 20px;
            text-align: center;
            background: var(--gray-50);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-zone:hover {
            border-color: var(--orange);
            background: #fff5f2;
        }

        .upload-zone.dragover {
            border-color: var(--orange);
            background: #fff5f2;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 10px;
        }

        .upload-hint {
            color: var(--gray-600);
            font-size: 0.95rem;
        }

        .file-input {
            display: none;
        }

        .file-info {
            margin-top: 20px;
            padding: 15px;
            background: var(--green);
            color: white;
            border-radius: 10px;
            display: none;
        }

        /* Text Input */
        .text-input-container {
            display: none;
        }

        .text-input-container.active {
            display: block;
        }

        .upload-zone.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .text-input {
            width: 100%;
            min-height: 300px;
            padding: 20px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--orange);
            box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.1);
        }

        /* Analyze Button */
        .analyze-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--orange) 0%, var(--orange-dark) 100%);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 12px;
            font-size: 1.25rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Loading Spinner */
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Quick Analysis Results */
        .quick-results {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border-top: 5px solid var(--orange);
        }

        .quick-results.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-badge {
            display: inline-block;
            font-size: 3rem;
            font-weight: 800;
            color: white;
            background: linear-gradient(135deg, var(--orange), var(--orange-dark));
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
        }

        .score-label {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-700);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .insight-card {
            padding: 20px;
            background: var(--gray-50);
            border-radius: 12px;
            border-left: 4px solid var(--orange);
        }

        .insight-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .insight-title {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 8px;
        }

        .insight-text {
            color: var(--gray-600);
            font-size: 0.95rem;
        }

        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, var(--blue) 0%, var(--blue-light) 100%);
            color: white;
            padding: 50px 40px;
            border-radius: 20px;
            text-align: center;
        }

        .cta-title {
            font-size: 2.25rem;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .cta-subtitle {
            font-size: 1.25rem;
            margin-bottom: 30px;
            opacity: 0.95;
        }

        .cta-btn {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: var(--orange);
            color: white;
            padding: 20px 40px;
            border-radius: 12px;
            font-size: 1.25rem;
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .cta-btn:hover {
            background: var(--orange-light);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.4);
        }

        /* Trust Indicators */
        .trust-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
            text-align: center;
        }

        .trust-item {
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .trust-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--orange);
            margin-bottom: 10px;
        }

        .trust-label {
            color: var(--gray-600);
        }

        /* Social Proof Ticker */
        .social-proof-ticker {
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--green);
            animation: slideInLeft 0.5s ease;
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .ticker-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ticker-icon {
            font-size: 1.5rem;
        }

        .ticker-text {
            flex: 1;
            font-size: 0.95rem;
            color: var(--gray-700);
        }

        .ticker-time {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        /* Live Typing Suggestions */
        .typing-suggestion {
            margin-top: 15px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #FFF3CD 0%, #FFE999 100%);
            border-radius: 8px;
            border-left: 4px solid var(--orange);
            display: none;
            animation: slideDown 0.3s ease;
        }

        .typing-suggestion.show {
            display: block;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .suggestion-text {
            font-size: 0.9rem;
            color: var(--gray-800);
            font-weight: 500;
        }

        /* Loading Progress States */
        .analysis-progress {
            display: none;
            margin: 30px 0;
            padding: 25px;
            background: var(--gray-50);
            border-radius: 12px;
        }

        .analysis-progress.show {
            display: block;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .progress-step.active {
            opacity: 1;
            border-left: 4px solid var(--orange);
            transform: translateX(5px);
        }

        .progress-step.completed {
            opacity: 1;
            border-left: 4px solid var(--green);
        }

        .step-icon {
            font-size: 1.5rem;
        }

        .step-text {
            flex: 1;
            font-weight: 500;
            color: var(--gray-700);
        }

        .step-check {
            color: var(--green);
            font-size: 1.25rem;
        }

        /* Exit Intent Modal */
        .exit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .exit-modal.show {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .exit-modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        .exit-modal h2 {
            font-size: 2rem;
            color: var(--orange);
            margin-bottom: 15px;
        }

        .exit-modal p {
            font-size: 1.125rem;
            color: var(--gray-700);
            margin-bottom: 25px;
        }

        .exit-modal-btns {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .exit-btn-primary {
            padding: 15px 30px;
            background: var(--orange);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .exit-btn-primary:hover {
            background: var(--orange-dark);
            transform: translateY(-2px);
        }

        .exit-btn-secondary {
            padding: 15px 30px;
            background: var(--gray-200);
            color: var(--gray-700);
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo { font-size: 2rem; }
            .tagline { font-size: 1.5rem; }
            .section-title { font-size: 1.5rem; }
            .upload-zone { padding: 40px 20px; }
            .upload-section { padding: 25px; }
            .cta-title { font-size: 1.75rem; }
            .exit-modal-content { padding: 25px; max-width: 90%; }
            .exit-modal h2 { font-size: 1.5rem; }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">Kandidaten<span class="accent">Tekort</span>.nl</div>
            <div style="color: var(--recruitin-orange); font-size: 0.875rem; font-weight: 600; margin-top: -5px; margin-bottom: 15px;">
                Powered by Recruitin
            </div>
            <h1 class="tagline">🎯 Verhoog Response Rate met 40-60%</h1>
            <p class="subtitle">Upload je vacature en ontvang direct een gratis AI-analyse. Vraag daarna je volledig geoptimaliseerde versie op!</p>
        </header>

        <!-- Social Proof Ticker -->
        <div class="social-proof-ticker" id="socialProofTicker">
            <div class="ticker-content">
                <span class="ticker-icon">🎉</span>
                <span class="ticker-text">
                    <strong id="tickerName">Marloes bij ProducentieBedrijf</strong> <span id="tickerAction">ontving zojuist haar geoptimaliseerde Technisch Operator vacature</span>
                </span>
                <span class="ticker-time" id="tickerTime">2 min geleden</span>
            </div>
        </div>

        <!-- Trust Indicators -->
        <div class="trust-section">
            <div class="trust-item">
                <div class="trust-number">150+</div>
                <div class="trust-label">Vacatures geanalyseerd</div>
            </div>
            <div class="trust-item">
                <div class="trust-number">40-60%</div>
                <div class="trust-label">Meer sollicitaties</div>
            </div>
            <div class="trust-item">
                <div class="trust-number">30 sec</div>
                <div class="trust-label">Analyse tijd</div>
            </div>
            <div class="trust-item">
                <div class="trust-number">100%</div>
                <div class="trust-label">Gratis analyse</div>
            </div>
        </div>

        <!-- Upload Section -->
        <section class="upload-section">
            <h2 class="section-title">📄 Plak Je Vacature</h2>
            <p class="section-subtitle">Plak je vacaturetekst hieronder voor een directe AI-analyse</p>

            <!-- Text Input Container -->
            <div class="text-input-container" style="display: block;">
                <textarea
                    id="vacatureText"
                    class="text-input"
                    placeholder="Plak hier je volledige vacaturetekst...

Voorbeeld:
Maintenance Engineer - Rotterdam

Voor onze productielocatie zoeken wij een ervaren Maintenance Engineer met minimaal 3 jaar ervaring in onderhoud van productie-installaties. Je werkt in 3-ploegendienst en bent verantwoordelijk voor preventief en correctief onderhoud. Wij bieden een salaris tussen €3.200-€4.200...

Minimaal 100 karakters voor een betrouwbare analyse."
                    maxlength="8000"
                ></textarea>
                <div style="text-align: right; color: var(--gray-600); margin-top: 8px;">
                    <span id="charCount">0</span> / 8000 karakters
                </div>

                <!-- Live Typing Suggestions -->
                <div class="typing-suggestion" id="typingSuggestion">
                    <span class="suggestion-text" id="suggestionText"></span>
                </div>
            </div>

            <!-- Analysis Progress -->
            <div class="analysis-progress" id="analysisProgress">
                <div class="progress-step" id="step1">
                    <span class="step-icon">📄</span>
                    <span class="step-text">Vacature inlezen...</span>
                    <span class="step-check"></span>
                </div>
                <div class="progress-step" id="step2">
                    <span class="step-icon">🤖</span>
                    <span class="step-text">AI analyse uitvoeren...</span>
                    <span class="step-check"></span>
                </div>
                <div class="progress-step" id="step3">
                    <span class="step-icon">✨</span>
                    <span class="step-text">Resultaten voorbereiden...</span>
                    <span class="step-check"></span>
                </div>
            </div>

            <!-- Analyze Button -->
            <button class="analyze-btn" id="analyzeBtn" onclick="startAnalysis()" disabled>
                <span id="btnIcon">🚀</span>
                <span id="btnText">Plak tekst om te beginnen</span>
            </button>
        </section>

        <!-- Quick Analysis Results -->
        <section class="quick-results" id="quickResults">
            <div class="results-header">
                <div class="score-badge" id="scoreBadge">-</div>
                <div class="score-label" id="scoreLabel">Vacature Score</div>
            </div>

            <h3 style="text-align: center; font-size: 1.5rem; margin-bottom: 25px; color: var(--gray-900);">
                📊 Snelle Analyse
            </h3>

            <div class="insights-grid" id="insightsGrid">
                <!-- Insights will be inserted here -->
            </div>

            <!-- CTA Section -->
            <div class="cta-section">
                <h3 class="cta-title">🎯 Wil je de volledige geoptimaliseerde vacature?</h3>
                <p class="cta-subtitle">Ontvang binnen 24 uur een professioneel herschreven versie die 40-60% meer sollicitaties genereert</p>
                <a href="https://form.typeform.com/to/z1GroMCc" target="_blank" class="cta-btn">
                    <span>📝</span>
                    <span>Vraag Geoptimaliseerde Vacature Op</span>
                    <span>→</span>
                </a>
                <p style="margin-top: 20px; font-size: 0.95rem; opacity: 0.9;">
                    ✓ Gratis analyse blijft beschikbaar • ✓ Geen verplichtingen • ✓ Response binnen 24 uur
                </p>
            </div>
        </section>

        <!-- Footer -->
        <footer style="text-align: center; padding: 40px 20px; color: var(--gray-600);">
            <p style="font-size: 0.875rem; margin-bottom: 10px;">
                Powered by <a href="https://recruitin.nl" target="_blank" style="color: var(--recruitin-orange); text-decoration: none; font-weight: 600;">Recruitin</a>
            </p>
            <p style="font-size: 0.75rem; opacity: 0.7;">
                © 2025 Recruitin • AI-powered recruitment oplossingen
            </p>
        </footer>
    </div>

    <!-- Exit Intent Modal -->
    <div class="exit-modal" id="exitModal">
        <div class="exit-modal-content">
            <h2>⏰ Wacht Nog Even!</h2>
            <p>Je bent nog <strong>1 klik</strong> verwijderd van je <strong>gratis vacature analyse</strong></p>
            <p style="font-size: 1rem; color: var(--gray-600);">Duizenden recruiters gingen je voor. Krijg binnen 30 seconden concrete tips!</p>
            <div class="exit-modal-btns">
                <button class="exit-btn-primary" onclick="closeExitModal(); scrollToUpload();">
                    🚀 Analyseer Nu Gratis
                </button>
                <button class="exit-btn-secondary" onclick="closeExitModal()">
                    Niet nu
                </button>
            </div>
        </div>
    </div>

    <script>
        let uploadedFile = null;
        let exitModalShown = false;

        // Character counter for text input + Live Suggestions
        let suggestionTimeout;
        document.getElementById('vacatureText').addEventListener('input', function() {
            const charCount = document.getElementById('charCount');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const btnText = document.getElementById('btnText');
            const text = this.value;

            charCount.textContent = text.length;

            if (text.trim().length >= 100) {
                analyzeBtn.disabled = false;
                btnText.textContent = 'Analyseer Vacature';
            } else {
                analyzeBtn.disabled = true;
                btnText.textContent = 'Minimaal 100 karakters vereist';
            }

            // FEATURE 5: Live Typing Suggestions
            clearTimeout(suggestionTimeout);
            suggestionTimeout = setTimeout(() => {
                showLiveSuggestion(text);
            }, 1500);
        });

        // Live typing suggestions
        function showLiveSuggestion(text) {
            const suggestion = document.getElementById('typingSuggestion');
            const suggestionText = document.getElementById('suggestionText');

            if (text.length < 100) return;

            let tip = '';

            // Check for common missing elements
            if (!text.match(/€|euro|salaris|loon/i)) {
                tip = '💡 <strong>Tip:</strong> Voeg een salarisindicatie toe voor 65% meer reacties';
            } else if (text.length > 200 && !text.match(/hybride|remote|thuiswerk/i)) {
                tip = '💡 <strong>Tip:</strong> Vermeld hybride/remote mogelijkheden - dit verhoogt sollicitaties met 43%';
            } else if (!text.match(/vakantie|vrij|dagen/i)) {
                tip = '💡 <strong>Tip:</strong> Noem het aantal vakantiedagen - transparantie vergroot vertrouwen';
            } else if (!text.match(/ontwikkel|training|groei|carri[eë]re/i)) {
                tip = '💡 <strong>Tip:</strong> Benadruk ontwikkelmogelijkheden - dit is cruciaal voor talent';
            }

            if (tip) {
                suggestionText.innerHTML = tip;
                suggestion.classList.add('show');

                // Auto hide after 10 seconds
                setTimeout(() => {
                    suggestion.classList.remove('show');
                }, 10000);
            }
        }

        // File handling
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                alert('❌ Bestand te groot. Maximaal 5MB toegestaan.');
                return;
            }

            // Validate file type
            const allowedTypes = ['.pdf', '.doc', '.docx', '.txt'];
            const fileExt = '.' + file.name.split('.').pop().toLowerCase();
            if (!allowedTypes.includes(fileExt)) {
                alert('❌ Ongeldig bestandstype. Gebruik: PDF, DOC, DOCX of TXT');
                return;
            }

            uploadedFile = file;

            // Show file info
            const fileInfo = document.getElementById('fileInfo');
            fileInfo.innerHTML = `✅ <strong>${file.name}</strong> (${(file.size / 1024).toFixed(1)} KB) - Klaar voor analyse!`;
            fileInfo.style.display = 'block';

            // Enable analyze button
            const analyzeBtn = document.getElementById('analyzeBtn');
            const btnText = document.getElementById('btnText');
            analyzeBtn.disabled = false;
            btnText.textContent = 'Analyseer Vacature';

            // Read file content for analysis
            readFileContent(file);
        }

        // Read file content
        function readFileContent(file) {
            const reader = new FileReader();

            reader.onload = function(e) {
                vacatureContent = e.target.result;

                // For text files, content is ready
                // For PDF/DOC, we'd need server-side processing
                // For now, we'll extract basic text
                if (file.type === 'text/plain') {
                    console.log('Text file loaded, ready for analysis');
                } else {
                    console.log('Binary file loaded, will be processed server-side');
                }
            };

            if (file.type === 'text/plain') {
                reader.readAsText(file);
            } else {
                reader.readAsDataURL(file);
            }
        }

        // Drag and drop
        const uploadZone = document.getElementById('uploadZone');

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('fileInput').files = files;
                handleFileSelect({ target: { files: files } });
            }
        });

        // Start Analysis with Progress States
        async function startAnalysis() {
            // Get text from textarea
            const textToAnalyze = document.getElementById('vacatureText').value.trim();

            if (!textToAnalyze || textToAnalyze.length < 100) {
                alert('⚠️ Voer minimaal 100 karakters in voor een betrouwbare analyse.');
                return;
            }

            // Show loading state
            const analyzeBtn = document.getElementById('analyzeBtn');
            const btnIcon = document.getElementById('btnIcon');
            const btnText = document.getElementById('btnText');

            analyzeBtn.disabled = true;
            btnIcon.innerHTML = '<div class="spinner"></div>';
            btnText.textContent = 'Analyseren...';

            // FEATURE 1: Show Progress States
            showProgressStates();

            try {
                // Call Claude API for quick analysis
                const analysis = await performQuickAnalysis(textToAnalyze);
                displayQuickResults(analysis);

                // Scroll to results
                document.getElementById('quickResults').scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });

            } catch (error) {
                console.error('Analysis error:', error);
                alert('❌ Er ging iets mis bij de analyse. Probeer het opnieuw.');
                hideProgressStates();
            } finally {
                // Reset button
                analyzeBtn.disabled = false;
                btnIcon.textContent = '🚀';
                btnText.textContent = 'Analyseer Opnieuw';
            }
        }

        // FEATURE 1: Progress Loading States
        async function showProgressStates() {
            const progress = document.getElementById('analysisProgress');
            const step1 = document.getElementById('step1');
            const step2 = document.getElementById('step2');
            const step3 = document.getElementById('step3');

            progress.classList.add('show');

            // Step 1: Reading
            step1.classList.add('active');
            await delay(800);
            step1.classList.remove('active');
            step1.classList.add('completed');
            step1.querySelector('.step-check').textContent = '✓';

            // Step 2: Analyzing
            step2.classList.add('active');
            await delay(1500);
            step2.classList.remove('active');
            step2.classList.add('completed');
            step2.querySelector('.step-check').textContent = '✓';

            // Step 3: Preparing
            step3.classList.add('active');
            await delay(800);
            step3.classList.remove('active');
            step3.classList.add('completed');
            step3.querySelector('.step-check').textContent = '✓';

            // Hide progress after delay
            setTimeout(() => {
                hideProgressStates();
            }, 1000);
        }

        function hideProgressStates() {
            const progress = document.getElementById('analysisProgress');
            progress.classList.remove('show');

            // Reset states
            const steps = [document.getElementById('step1'), document.getElementById('step2'), document.getElementById('step3')];
            steps.forEach(step => {
                step.classList.remove('active', 'completed');
                step.querySelector('.step-check').textContent = '';
            });
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Perform Quick Analysis (VERBETERDE PROMPT V2)
        async function performQuickAnalysis(text) {
            const quickPrompt = `Je bent een Nederlandse recruitment AI gespecialiseerd in vacature optimalisatie.

ANALYSE OPDRACHT:
Geef een KORTE, PAKKENDE analyse van deze vacature.

VACATURE TEKST:
${text.substring(0, 2000)}

NEDERLANDSE MARKT CONTEXT 2025:
- Kandidaten eisen salaris transparantie (65% meer respons)
- Hybride werken is standaard (70% kandidaten verwacht dit)
- Werk-privé balans > salaris voor veel kandidaten
- Gemiddelde Time-to-Hire: 45-60 dagen
- 73% sollicitanten leest vacature op mobiel

RETURN FORMAT (JSON only):
{
  "score": X,
  "insights": [
    {
      "icon": "💰",
      "title": "Pakkende 2-4 woorden titel",
      "text": "Concrete 1-zin feedback met % impact. Bijv: Voeg salaris toe voor 65% meer sollicitaties."
    },
    {
      "icon": "📊",
      "title": "Pakkende 2-4 woorden titel",
      "text": "Concrete actie met business impact"
    },
    {
      "icon": "🎯",
      "title": "Pakkende 2-4 woorden titel",
      "text": "Specifieke verbetering met resultaat"
    }
  ]
}

REGELS:
- Score 1-10 (wees eerlijk, niet te aardig)
- Insights MOETEN actionable zijn met concrete cijfers
- Focus op hoogste impact items (salaris, hybride, cultuur)
- Nederlandse taal, professioneel maar toegankelijk`;

            try {
                const response = await fetch('/.netlify/functions/claude-analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: quickPrompt,
                        max_tokens: 800
                    })
                });

                if (!response.ok) throw new Error('API call failed');

                const data = await response.json();
                let content = data.content[0].text;

                // Clean JSON
                content = content.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();

                return JSON.parse(content);
            } catch (error) {
                console.error('API error:', error);

                // Fallback mock analysis
                return generateMockQuickAnalysis(text);
            }
        }

        // Mock quick analysis (VERBETERDE VERSIE - Realistisch & Kritisch)
        function generateMockQuickAnalysis(text) {
            const textLower = text.toLowerCase();

            // Analyze multiple factors
            const hasSalary = /€|euro|salaris|loon/i.test(text);
            const hasLocation = /amsterdam|rotterdam|utrecht|eindhoven|den haag|groningen|brabant/i.test(text);
            const hasHybrid = /hybride|remote|thuiswerk|thuis werken/i.test(textLower);
            const hasVacation = /vakantie|vrij|dagen|adv/i.test(textLower);
            const hasDevelopment = /ontwikkel|training|groei|carri[eë]re|opleiding/i.test(textLower);
            const hasBenefits = /bonus|pensioen|lease|laptop|telefoon/i.test(textLower);
            const wordCount = text.split(/\s+/).length;

            // Calculate realistic score (max 7, meestal 4-6)
            let score = 3; // Start laag

            if (hasSalary) score += 1.5;
            if (hasHybrid) score += 1;
            if (wordCount > 100) score += 0.5;
            if (wordCount > 200) score += 0.5;
            if (hasDevelopment) score += 0.5;
            if (hasBenefits) score += 0.5;

            // Cap at 7 (never perfect!)
            score = Math.min(Math.round(score * 10) / 10, 7);

            // ALWAYS find improvements (altijd kritisch!)
            const insights = [];

            // Insight 1: Salaris (altijd verbetering mogelijk)
            if (!hasSalary) {
                insights.push({
                    icon: "💰",
                    title: "Geen salaris vermeld ✗",
                    text: "Voeg concrete salaris range toe (€X-€X) voor 65% meer sollicitaties"
                });
            } else {
                insights.push({
                    icon: "💰",
                    title: "Salaris aanwezig",
                    text: "Goed! Zet het ook in de titel voor 40% meer klikken: 'Senior Dev | €60K-75K'"
                });
            }

            // Insight 2: Hybride werken (bijna altijd missing of kan beter)
            if (!hasHybrid) {
                insights.push({
                    icon: "🏠",
                    title: "Hybride ontbreekt",
                    text: "Vermeld hybride/remote mogelijkheden - 70% kandidaten verwacht dit in 2025"
                });
            } else {
                insights.push({
                    icon: "🏠",
                    title: "Hybride vermeld",
                    text: "Wees specifieker: '3 dagen thuis, 2 dagen kantoor' werkt beter dan 'hybride'"
                });
            }

            // Insight 3: Altijd een kritisch punt
            if (wordCount < 100) {
                insights.push({
                    icon: "📊",
                    title: "Vacature te kort",
                    text: "Nu ${wordCount} woorden - verhoog naar 150-300 voor betere conversie"
                });
            } else if (!hasDevelopment) {
                insights.push({
                    icon: "🚀",
                    title: "Ontwikkeling ontbreekt",
                    text: "Vermeld ontwikkelbudget/trainingen - dit trekt 43% meer talent aan"
                });
            } else if (!hasBenefits) {
                insights.push({
                    icon: "🎁",
                    title: "Benefits onduidelijk",
                    text: "Noem specifieke benefits: pensioen %, laptop merk, bonus structuur"
                });
            } else {
                insights.push({
                    icon: "📱",
                    title: "Moderniseer format",
                    text: "Gebruik bullets (•), emoji's en witruimte - 73% leest op mobiel"
                });
            }

            return {
                score: score,
                insights: insights
            };
        }

        // Display quick results with Animated Score
        function displayQuickResults(analysis) {
            const scoreBadge = document.getElementById('scoreBadge');
            const scoreLabel = document.getElementById('scoreLabel');
            const insightsGrid = document.getElementById('insightsGrid');
            const quickResults = document.getElementById('quickResults');

            // FEATURE 3: Animated Score Reveal
            animateScore(analysis.score, scoreBadge);

            const scoreText = analysis.score >= 8 ? 'Uitstekend!' :
                            analysis.score >= 6 ? 'Goed' :
                            analysis.score >= 4 ? 'Gemiddeld' : 'Verbetering Nodig';
            scoreLabel.textContent = scoreText;

            // Update insights
            insightsGrid.innerHTML = analysis.insights.map(insight => `
                <div class="insight-card">
                    <div class="insight-icon">${insight.icon}</div>
                    <div class="insight-title">${insight.title}</div>
                    <div class="insight-text">${insight.text}</div>
                </div>
            `).join('');

            // Show results
            quickResults.classList.add('show');
        }

        // FEATURE 3: Animated Score Counter
        function animateScore(targetScore, element) {
            let currentScore = 0;
            const duration = 1500;
            const increment = targetScore / (duration / 16);

            const timer = setInterval(() => {
                currentScore += increment;
                if (currentScore >= targetScore) {
                    element.textContent = targetScore + '/10';
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(currentScore) + '/10';
                }
            }, 16);
        }

        // FEATURE 4: Exit Intent Detection
        let exitIntentTriggered = false;

        document.addEventListener('mouseleave', (e) => {
            // Only trigger when mouse leaves top of viewport
            if (e.clientY < 50 && !exitIntentTriggered && !exitModalShown) {
                const vacText = document.getElementById('vacatureText').value.trim();
                // Only show if user hasn't uploaded/typed yet
                if (vacText.length < 50 && !uploadedFile) {
                    showExitModal();
                    exitIntentTriggered = true;
                }
            }
        });

        function showExitModal() {
            const modal = document.getElementById('exitModal');
            modal.classList.add('show');
            exitModalShown = true;
        }

        function closeExitModal() {
            const modal = document.getElementById('exitModal');
            modal.classList.remove('show');
        }

        function scrollToUpload() {
            const uploadSection = document.querySelector('.upload-section');
            uploadSection.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Focus on text input
            const textTab = document.getElementById('textTab');
            if (!textTab.classList.contains('active')) {
                switchTab('text');
            }
            setTimeout(() => {
                document.getElementById('vacatureText').focus();
            }, 500);
        }

        // FEATURE 2: Social Proof Ticker (rotate every 8 seconds)
        const socialProofData = [
            { name: 'Marloes bij ProducentieBedrijf', action: 'ontving zojuist haar geoptimaliseerde Technisch Operator vacature', time: '2 min geleden' },
            { name: 'Pieter van BouwGroep', action: 'analyseerde een Werkvoorbereider vacature', time: '5 min geleden' },
            { name: 'Sophie bij Manufacturing NL', action: 'kreeg een score van 6.5/10 voor haar Productie Manager rol', time: '12 min geleden' },
            { name: 'Thomas van Logistics Solutions', action: 'uploadde een Maintenance Engineer vacature', time: '18 min geleden' },
            { name: 'Emma bij IndustriePark', action: 'ontving een volledige analyse voor Technisch Servicemonteur', time: '23 min geleden' }
        ];

        let currentProofIndex = 0;

        function rotateSocialProof() {
            const ticker = document.getElementById('socialProofTicker');
            const tickerName = document.getElementById('tickerName');
            const tickerAction = document.getElementById('tickerAction');
            const tickerTime = document.getElementById('tickerTime');

            // Fade out
            ticker.style.opacity = '0';
            ticker.style.transform = 'translateX(-20px)';

            setTimeout(() => {
                // Update content
                currentProofIndex = (currentProofIndex + 1) % socialProofData.length;
                const proof = socialProofData[currentProofIndex];

                tickerName.textContent = proof.name;
                tickerAction.textContent = proof.action;
                tickerTime.textContent = proof.time;

                // Fade in
                ticker.style.opacity = '1';
                ticker.style.transform = 'translateX(0)';
            }, 300);
        }

        // Start ticker rotation
        setInterval(rotateSocialProof, 8000);

        // Add transition styles
        const ticker = document.getElementById('socialProofTicker');
        ticker.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
    </script>
</body>
</html>
